<include file="Public:header" />

<!--=== Breadcrumbs ===-->
<div class="row-fluid breadcrumbs margin-bottom-20">
<div class="container">
    <h1 class="pull-left">管理中心</h1>
    <ul class="pull-right breadcrumb">
        <li></li>
    </ul>
</div><!--/container-->
</div><!--/breadcrumbs-->
<!--=== End Breadcrumbs ===-->

<!--=== Content Part ===-->
<div class="container content recent"> 	
    <div class="row">
    <!-- Begin Sidebar Menu -->
		<include file="Public:xiaokeMenu" />
<!-- End Sidebar Menu -->

        <div class="col-md-9">
           <div class="margin-bottom-20">
            <div class="panel pgy-panel-sea margin-bottom-40">
                <div class="panel-heading pgy-panel-heading">
                  <h3 class="panel-title" style="color:#fff">
                    <i class="fa fa-angle-double-right"></i>添加店铺 &nbsp;
                   </h3>
                </div>
	            <form class="reg-page sky-form" id="form" method="POST" action="__URL__/addShopHandle" >
	            		<div class="reg-header">
		                    <p><img id="thumbnail_img" src="" style="width:200px;height:150px"></p>
		                    <br>
		                </div>
						<section>
		                    <label class="input">
		                    <a href="javascript:void(0);" id="uploader-screenshot" class="btn-u btn-u-xs app_edit_screenshot_upload_button" style="position: relative; overflow: hidden; direction: ltr;"><i class="fa fa-picture-o"></i>
		                     	上传店铺封面<input id="thumbnail" type="file" name="thumbnail" style="position: absolute; right: 0px; top: 0px; font-family: Arial; font-size: 118px; margin: 0px; padding: 0px; cursor: pointer; opacity: 0;" /></a>
		                    </label>
		                </section>
		                <section>
		                    <label class="label">店铺分类</label>
	                    	<input id="xc" name="1" type="checkbox" value="1" checked="checked" /><span style="font-size:24px">&nbsp&nbsp洗车&nbsp&nbsp</span>
	                    	<input id="wx" name="2" type="checkbox" value="2" checked="checked" /><span style="font-size:24px">&nbsp&nbsp维修&nbsp&nbsp</span>
	                    	<input id="by" name="3" type="checkbox" value="3" checked="checked" /><span style="font-size:24px">&nbsp&nbsp保养&nbsp&nbsp</span>
		                </section>
		                <section id="sxiche">
		                    <label class="label">洗车价格</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="xiche" name="xiche" value="" >
		                    </label>
		                </section>
		                <section id="sweixiu">
		                    <label class="label">维修价格</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="weixiu" name="weixiu" value="" >
		                    </label>
		                </section>
		                <section id="sbaoyang">
		                    <label class="label">保养价格</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="baoyang" name="baoyang" value="" >
		                    </label>
		                </section>
                        <section>
		                    <label class="label">名称</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="name" name="name" value="" placeholder="请输入名称">
		                    </label>
		                </section>
		                <section>
		                    <label class="label">评价</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="score" name="score" value="" placeholder="请输入评价">
		                    </label>
		                </section>
		                 <section>
		                    <label class="label">经度（通过百度地图获取）</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="longitude" name="longitude" value="" placeholder="请输入经度">
		                    </label>
		                </section>
		                 <section>
		                    <label class="label">纬度（通过百度获取）</label>
		                    <label class="input">
		                        <i class="icon-append fa fa-pencil"></i>
		                        <input type="text" id="latitude" name="latitude" value="" placeholder="请输入纬度">
		                    </label>
		                </section>
		                <section>
		                    <label class="label">简介</label>
		                    <label class="textarea textarea-resizable">
		                        <textarea id="desc" name="desc" rows="4" class="textArea" /></textarea>
		                    </label>
		                </section>
		                <section>
		                    <label class="label">详情(输入网址)</label>
		                    <label class="textarea textarea-resizable">
		                        <textarea id="content" name="content" rows="2" class="textArea" /></textarea>
		                    </label>
		                </section>
		                <section>
		                    <label class="label">商品详情(输入网址)</label>
		                    <label class="textarea textarea-resizable">
		                        <textarea id="pcontent" name="pcontent" rows="2" class="textArea" /></textarea>
		                    </label>
		                </section>
		                <div class="row">
		                    <div class="col-md-6 col-xs-6 text-left">
		                        <span id="syncAppStoreIng" style="height:32px; display:none; line-height:32px; color:#ccc;">同步中，请稍后...
		                    </span></div>
		                    <div class="col-md-6 col-xs-6 text-right">
		                        <button class="btn-u" type="submit" id="submitButton" onclick="submitForm()">添加</button>
		                    </div>
		                </div>
		        </form>
            </div>
        </div>
        <!--End Striped Rows-->
    </div>
    <div class="pager">
        </div>

</div><!--/container-->
<!--=== End Content Part ===-->
<!-- JS Page Level -->
<script type="text/javascript">
  
$('.navbar-nav').each(function() {
	$('.navbar-nav li').attr("class","");
});
$("#gl").attr("class","active");
$('.collapse in').each(function() {
	$('.collapse in li').attr("class","");
});
$("#tjdp").attr("class","current");

$(function(){
	$("#thumbnail").live('change',function(){ 
		ajaxThumbnailUpload();
	});
	
	/* window.UEDITOR_CONFIG.initialFrameHeight = 200;
	UE.getEditor('content'); */
	
	$("#xc").click(function(){
		if($("#xc").is(':checked')){
			$("#sxiche").css("display","inline");
		}else{
			$("#sxiche").css("display","none");
		}
	});
	
	$("#by").click(function(){
		if($("#by").is(':checked')){
			$("#sbaoyang").css("display","inline");
		}else{
			$("#sbaoyang").css("display","none");
		}
	});
	
	$("#wx").click(function(){
		if($("#wx").is(':checked')){
			$("#sweixiu").css("display","inline");
		}else{
			$("#sweixiu").css("display","none");
		}
	});
});

function ajaxThumbnailUpload() {
	var path = 'Public/upload/';
    $.ajaxFileUpload
		(
			{
				url: '__GROUP__/Shop/uploadThumbnailHandle',
				secureuri:false,
				fileElementId:'thumbnail',
				dataType: 'json',
				success: function (data, status)
				{
					if(typeof(data.error) != 'undefined')
					{
						if(data.error != '')
						{
							alert(data.error);
						}else
						{
							$("#thumbnail_img").attr("src", path + data.msg);
							if($("#thumbnailName")){
								$("#thumbnailName").remove();
							}
							$("#form").append('<input type="hidden" id="thumbnailName" name="thumbnailName" value="'+ data.msg +'" />');
						}
					}
				},
				error: function (data, status, e)
				{
					alert(e);
				}
			}
		)
    return false;
}

var loading=0;
function submitForm(){
	if(loading){
		return false;
	}
	$('#form').ajaxForm({
	     beforeSubmit:  checkForm,// pre-submit callback
	     success:       complete,// post-submit callback
	     dataType: 'json'
	});
	loading=1;
    function checkForm(){
    	if(!$.trim ( $('#thumbnailName').val() )){
    		alert('请上传图片');
    		return false;
    	}
    	if(!$.trim ( $('#name').val() )){
    		alert('请填写名称');
    		return false;
    	}
    	if(!$.trim ( $('#score').val() )){
    		alert('请填写评价');
    		return false;
    	}
    	if(!$.trim ( $('#desc').val() )){
    		alert('请填写简介');
    		return false;
    	}
    }
    function complete(d){
        if (d.error == ""){
        	alert("保存成功");
        	window.location.href="__URL__/shop";
        }else{
        	alert(d.error);
        	loading=0;
        }
    }
    
}
</script>


</body></html>